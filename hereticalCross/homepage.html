<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title> <!-- Title will be set dynamically -->
    <style>
        #messages {
            list-style-type: none; /* Remove bullet points */
            padding: 0; /* Remove padding */
        }
    </style>
</head>
<body>
    <h1>Welcome to the Reflected XSS Vulnerable Page</h1>
    
    <form id="message-form">
        <input type="text" id="user-input" placeholder="Enter your message" required>
        <button type="submit">Submit</button>
    </form>

    <h2>Your Messages:</h2>
    <ul id="messages"></ul> <!-- This is where the messages will be displayed -->

    <script>
        // Function to handle form submission
        document.getElementById('message-form').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the form from submitting normally

            const message = document.getElementById('user-input').value; // Get the user input

            // Create a new list item for the message
            const li = document.createElement('li');

            // Regex to match <script>alert(<flag here>)</script>
            const scriptRegex = /<script>alert\((.*?)\)<\/script>/;

            // Check if the input matches the script pattern
            const match = message.match(scriptRegex);
            if (match) {
                const flag = match[1]; // Extract the flag from the regex match
                document.title = flag; // Set the document title to the flag
                
                // Create a new script element to execute the alert
                const script = document.createElement('script');
                script.textContent = `alert('${flag}');`; // Set the alert content
                document.body.appendChild(script); // Append the script to the body to execute it
            } else {
                li.innerHTML = message; // Directly inserting user input into the page (vulnerable to XSS)
            }

            document.getElementById('messages').appendChild(li); // Append the list item to the messages list

            // Clear the input field
            document.getElementById('user-input').value = '';
        });
    </script>
</body>
</html>